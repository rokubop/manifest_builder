# Manifest builder for Talon packages

Automatically generates a `manifest.json` for your Talon packages (folders), discovering contributed entities, tracking dependencies, and resolving them to specific package versions.

## Installation

Clone this repository into your Talon user directory:

```bash
cd ~/talon/user  # or your talon user path
git clone https://github.com/rokubop/manifest_builder
```

## Usage

### Generate Manifest

Navigate to the manifest_builder directory and run it on your target folder(s):

```bash
cd manifest_builder
python generate_manifest.py ../my-package
python generate_manifest.py ../package1 ../package2
```

A `manifest.json` file will be generated in each specified directory. If a `manifest.json` already exists, it will respect the current values and just be updated with the new information.

### Generate Version File (Optional)

Generate a version file that exposes your package version:

```bash
python generate_version.py ../my-package
```

This creates a `_version.py` file with an action like `actions.user.my_package_version()` that returns `(major, minor, patch)` from manifest.json. Other packages can then check your version at runtime for compatibility.

## How Manifest Generation Works

1. **Scans your folder** - Analyzes Python files to detect contributed and dependent Talon entities
2. **Scans the `user` directory** - Finds all other folders with manifests (generated by this tool)
3. **Resolves dependencies** - Matches your entity dependencies to specific folders and versions
4. **Generates/updates manifest.json** - Including metadata, contributes, depends, and resolved dependencies

## Example Manifest Output

```json
{
  "name": "my-package",
  "version": "1.0.0",
  "namespace": "my_package",
  "dependencies": {
    "ui_elements": "0.10.0"
  },
  "devDependencies": {},
  "contributes": {
    "actions": ["user.my_package_action"]
  },
  "depends": {
    "actions": ["user.ui_elements_show"]
  }
}
```

**Note**: `devDependencies` is available for dependencies only needed for testing/development. The generator doesn't populate this automatically - move items manually as needed.